using System;
using System.IO;

namespace Elements.Geometry.Profiles
{
    /// <summary>
    /// A singleton class which serves every HSS pipe section as defined by AISC.
    /// </summary>
    public sealed class HSSPipeProfileServer : ProfileServer
    {
        private static string _data = @"
Shape,O.D.,I.D.,t,wt./ft.,A,I,S,r,J
HSS20.000x0.500,20,19.07,0.465,104,28.5,1360,136,6.91,2720
HSS20.000x0.375,20,19.302,0.349,78.7,21.5,1040,104,6.95,2080
HSS18.000x0.500,18,17.07,0.465,93.5,25.6,985,109,6.2,1970
HSS18.000x0.375,18,17.302,0.349,70.7,19.4,754,83.8,6.24,1510
HSS16.000x0.500,16,15.07,0.465,82.8,22.7,685,85.7,5.49,1370
HSS16.000x0.438,16,15.186,0.407,72.9,19.9,606,75.8,5.51,1210
HSS16.000x0.375,16,15.302,0.349,62.6,17.2,526,65.7,5.53,1050
HSS16.000x0.312,16,15.418,0.291,52.3,14.4,443,55.4,5.55,886
HSS14.000x0.500,14,13.07,0.465,72.2,19.8,453,64.8,4.79,907
HSS14.000x0.375,14,13.302,0.349,54.6,15,349,49.8,4.83,698
HSS14.000x0.312,14,13.418,0.291,45.7,12.5,295,42.1,4.85,589
HSS12.750x0.500,12.75,11.82,0.465,65.5,17.9,339,53.2,4.35,678
HSS12.750x0.375,12.75,12.052,0.349,49.6,13.6,262,41,4.39,523
HSS12.750x0.250,12.75,12.284,0.233,33.4,9.16,180,28.2,4.43,359
HSS12.500x0.625,12.5,11.338,0.581,79.3,21.8,387,62,4.22,774
HSS12.500x0.500,12.5,11.57,0.465,64.1,17.6,319,51,4.26,638
HSS12.500x0.375,12.5,11.802,0.349,48.6,13.3,246,39.4,4.3,492
HSS12.500x0.312,12.5,11.918,0.291,40.7,11.2,208,33.3,4.32,416
HSS12.500x0.250,12.5,12.034,0.233,32.7,8.98,169,27,4.34,338
HSS12.500x0.188,12.5,12.152,0.174,24.7,6.74,128,20.5,4.36,256
HSS11.250x0.625,11.25,10.088,0.581,71,19.5,278,49.4,3.78,556
HSS11.250x0.500,11.25,10.32,0.465,57.5,15.8,229,40.8,3.82,459
HSS11.250x0.375,11.25,10.552,0.349,43.6,12,178,31.6,3.86,355
HSS11.250x0.312,11.25,10.668,0.291,36.5,10,151,26.8,3.88,301
HSS11.250x0.250,11.25,10.784,0.233,29.4,8.06,122,21.8,3.9,245
HSS11.250x0.188,11.25,10.902,0.174,22.2,6.05,92.9,16.5,3.92,186
HSS10.750x0.500,10.75,9.82,0.465,54.8,15,199,37,3.64,398
HSS10.750x0.250,10.75,10.284,0.233,28.1,7.7,106,19.8,3.72,213
HSS10.000x0.625,10,8.838,0.581,62.6,17.2,191,38.3,3.34,383
HSS10.000x0.500,10,9.07,0.465,50.8,13.9,159,31.7,3.38,317
HSS10.000x0.375,10,9.302,0.349,38.6,10.6,123,24.7,3.41,247
HSS10.000x0.312,10,9.418,0.291,32.3,8.88,105,20.9,3.43,209
HSS10.000x0.250,10,9.534,0.233,26.1,7.15,85.3,17.1,3.45,171
HSS10.000x0.188,10,9.652,0.174,19.7,5.37,64.8,13,3.47,130
HSS9.625x0.500,9.625,8.695,0.465,48.8,13.4,141,29.2,3.24,281
HSS9.625x0.375,9.625,8.927,0.349,37.1,10.2,110,22.8,3.28,219
HSS9.625x0.312,9.625,9.043,0.291,31.1,8.53,93,19.3,3.3,186
HSS9.625x0.250,9.625,9.159,0.233,25.1,6.87,75.9,15.8,3.32,152
HSS9.625x0.188,9.625,9.277,0.174,19,5.17,57.7,12,3.34,115
HSS8.750x0.500,8.75,7.82,0.465,44.1,12.1,104,23.8,2.93,208
HSS8.750x0.375,8.75,8.052,0.349,33.6,9.21,81.4,18.6,2.97,163
HSS8.750x0.312,8.75,8.168,0.291,28.1,7.73,69.3,15.8,2.99,139
HSS8.750x0.250,8.75,8.284,0.233,22.7,6.23,56.6,12.9,3.01,113
HSS8.750x0.188,8.75,8.402,0.174,17.2,4.69,43.1,9.86,3.03,86.2
HSS8.625x0.500,8.625,7.695,0.465,43.4,11.9,99.5,23.1,2.89,199
HSS8.625x0.375,8.625,7.927,0.349,33.1,9.07,77.8,18,2.93,156
HSS8.625x0.322,8.625,8.025,0.3,28.6,7.85,68.1,15.8,2.95,136
HSS8.625x0.250,8.625,8.159,0.233,22.4,6.14,54.1,12.5,2.97,108
HSS8.625x0.188,8.625,8.277,0.174,17,4.62,41.3,9.57,2.99,82.5
HSS7.625x0.125,7.625,7.393,0.116,10,2.74,19.3,5.06,2.66,38.6
HSS7.500x0.500,7.5,6.57,0.465,37.4,10.3,63.9,17,2.49,128
HSS7.500x0.375,7.5,6.802,0.349,28.6,7.84,50.2,13.4,2.53,100
HSS7.500x0.312,7.5,6.918,0.291,24,6.59,42.9,11.4,2.55,85.8
HSS7.500x0.250,7.5,7.034,0.233,19.4,5.32,35.2,9.37,2.57,70.3
HSS7.500x0.188,7.5,7.152,0.174,14.7,4,26.9,7.17,2.59,53.8
HSS7.000x0.500,7,6.07,0.465,34.7,9.55,51.2,14.6,2.32,102
HSS7.000x0.375,7,6.302,0.349,26.6,7.29,40.4,11.6,2.35,80.9
HSS7.000x0.312,7,6.418,0.291,22.3,6.13,34.6,9.88,2.37,69.1
HSS7.000x0.250,7,6.534,0.233,18,4.95,28.4,8.11,2.39,56.8
HSS7.000x0.188,7,6.652,0.174,13.7,3.73,21.7,6.21,2.41,43.5
HSS7.000x0.125,7,6.768,0.116,9.19,2.51,14.9,4.25,2.43,29.7
HSS6.875x0.500,6.875,5.945,0.465,34.1,9.36,48.3,14.1,2.27,96.7
HSS6.875x0.375,6.875,6.177,0.349,26.1,7.16,38.2,11.1,2.31,76.4
HSS6.875x0.312,6.875,6.293,0.291,21.9,6.02,32.7,9.51,2.33,65.4
HSS6.875x0.250,6.875,6.409,0.233,17.7,4.86,26.8,7.81,2.35,53.7
HSS6.875x0.188,6.875,6.527,0.174,13.4,3.66,20.6,5.99,2.37,41.1
HSS6.625x0.500,6.625,5.695,0.465,32.7,9,42.9,13,2.18,85.9
HSS6.625x0.432,6.625,5.819,0.403,28.6,7.88,38.3,11.6,2.2,76.6
HSS6.625x0.375,6.625,5.927,0.349,25.1,6.88,34,10.3,2.22,68
HSS6.625x0.312,6.625,6.043,0.291,21.1,5.79,29.1,8.79,2.24,58.2
HSS6.625x0.280,6.625,6.103,0.261,19,5.22,26.5,7.99,2.25,52.9
HSS6.625x0.250,6.625,6.159,0.233,17,4.68,23.9,7.22,2.26,47.9
HSS6.625x0.188,6.625,6.277,0.174,12.9,3.53,18.4,5.54,2.28,36.7
HSS6.625x0.125,6.625,6.393,0.116,8.69,2.37,12.6,3.79,2.3,25.1
HSS6.125x0.500,6.125,5.195,0.465,30.1,8.27,33.3,10.9,2.01,66.7
HSS6.125x0.375,6.125,5.427,0.349,23.1,6.33,26.5,8.66,2.05,53
HSS6.125x0.312,6.125,5.543,0.291,19.4,5.33,22.7,7.43,2.07,45.5
HSS6.125x0.250,6.125,5.659,0.233,15.7,4.31,18.7,6.12,2.08,37.5
HSS6.125x0.188,6.125,5.777,0.174,11.9,3.25,14.4,4.71,2.1,28.8
HSS6.000x0.500,6,5.07,0.465,29.4,8.09,31.2,10.4,1.96,62.4
HSS6.000x0.375,6,5.302,0.349,22.5,6.2,24.8,8.28,2,49.7
HSS6.000x0.312,6,5.418,0.291,19,5.22,21.3,7.11,2.02,42.6
HSS6.000x0.280,6,5.478,0.261,17.1,4.71,19.4,6.47,2.03,38.8
HSS6.000x0.250,6,5.534,0.233,15.4,4.22,17.6,5.86,2.04,35.2
HSS6.000x0.188,6,5.652,0.174,11.7,3.18,13.5,4.51,2.06,27
HSS6.000x0.125,6,5.768,0.116,7.85,2.14,9.28,3.09,2.08,18.6
HSS5.563x0.375,5.563,4.865,0.349,20.8,5.72,19.5,7.02,1.85,39
HSS5.563x0.258,5.563,5.081,0.241,14.6,4.03,14.3,5.14,1.88,28.6
HSS5.563x0.188,5.563,5.215,0.174,10.8,2.95,10.7,3.85,1.91,21.4
HSS5.563x0.134,5.563,5.313,0.125,7.78,2.14,7.9,2.84,1.92,15.8
HSS5.500x0.500,5.5,4.57,0.465,26.7,7.36,23.5,8.55,1.79,47
HSS5.500x0.375,5.5,4.802,0.349,20.5,5.65,18.8,6.84,1.83,37.6
HSS5.500x0.258,5.5,5.018,0.241,14.5,3.98,13.8,5.02,1.86,27.6
HSS5.000x0.500,5,4.07,0.465,24.1,6.62,17.2,6.88,1.61,34.4
HSS5.000x0.375,5,4.302,0.349,18.5,5.1,13.9,5.55,1.65,27.7
HSS5.000x0.312,5,4.418,0.291,15.6,4.3,12,4.79,1.67,24
HSS5.000x0.258,5,4.518,0.241,13.1,3.6,10.2,4.09,1.68,20.5
HSS5.000x0.250,5,4.534,0.233,12.7,3.49,9.94,3.97,1.69,19.9
HSS5.000x0.188,5,4.652,0.174,9.67,2.64,7.69,3.08,1.71,15.4
HSS5.000x0.125,5,4.768,0.116,6.51,1.78,5.31,2.12,1.73,10.6
HSS4.500x0.337,4.5,3.87,0.315,15,4.14,9.12,4.05,1.48,18.2
HSS4.500x0.237,4.5,4.058,0.221,10.8,2.97,6.82,3.03,1.51,13.6
HSS4.500x0.188,4.5,4.152,0.174,8.67,2.36,5.54,2.46,1.53,11.1
HSS4.500x0.125,4.5,4.268,0.116,5.85,1.6,3.84,1.71,1.55,7.68
HSS4.000x0.337,4,3.37,0.315,13.2,3.65,6.24,3.12,1.31,12.5
HSS4.000x0.313,4,3.418,0.291,12.3,3.39,5.87,2.93,1.32,11.7
HSS4.000x0.250,4,3.534,0.233,10,2.76,4.91,2.45,1.33,9.82
HSS4.000x0.237,4,3.558,0.221,9.53,2.62,4.7,2.35,1.34,9.4
HSS4.000x0.226,4,3.578,0.211,9.12,2.51,4.52,2.26,1.34,9.04
HSS4.000x0.220,4,3.59,0.205,8.89,2.44,4.41,2.21,1.34,8.83
HSS4.000x0.188,4,3.652,0.174,7.66,2.09,3.83,1.92,1.35,7.67
HSS4.000x0.125,4,3.768,0.116,5.18,1.42,2.67,1.34,1.37,5.34
HSS3.500x0.313,3.5,2.918,0.291,10.7,2.93,3.81,2.18,1.14,7.61
HSS3.500x0.300,3.5,2.94,0.28,10.3,2.83,3.7,2.11,1.14,7.4
HSS3.500x0.250,3.5,3.034,0.233,8.69,2.39,3.21,1.83,1.16,6.41
HSS3.500x0.216,3.5,3.098,0.201,7.58,2.08,2.84,1.63,1.17,5.69
HSS3.500x0.203,3.5,3.122,0.189,7.15,1.97,2.7,1.54,1.17,5.41
HSS3.500x0.188,3.5,3.152,0.174,6.66,1.82,2.52,1.44,1.18,5.04
HSS3.500x0.125,3.5,3.268,0.116,4.51,1.23,1.77,1.01,1.2,3.53
HSS3.000x0.300,3,2.44,0.28,8.66,2.39,2.24,1.49,0.967,4.47
HSS3.000x0.250,3,2.534,0.233,7.35,2.03,1.95,1.3,0.982,3.9
HSS3.000x0.216,3,2.598,0.201,6.43,1.77,1.74,1.16,0.992,3.48
HSS3.000x0.203,3,2.622,0.189,6.07,1.67,1.66,1.1,0.996,3.31
HSS3.000x0.188,3,2.652,0.174,5.65,1.54,1.55,1.03,1,3.1
HSS3.000x0.152,3,2.716,0.142,4.63,1.27,1.3,0.87,1.01,2.61
HSS3.000x0.134,3,2.75,0.125,4.11,1.13,1.17,0.779,1.02,2.34
HSS3.000x0.120,3,2.776,0.112,3.69,1.02,1.06,0.707,1.02,2.12
HSS2.875x0.250,2.875,2.409,0.233,7.02,1.93,1.7,1.18,0.938,3.4
HSS2.875x0.203,2.875,2.497,0.189,5.8,1.59,1.45,1.01,0.952,2.89
HSS2.875x0.188,2.875,2.527,0.174,5.4,1.48,1.35,0.941,0.957,2.7
HSS2.875x0.125,2.875,2.643,0.116,3.67,1.01,0.958,0.667,0.976,1.92
HSS2.500x0.250,2.5,2.034,0.233,6.01,1.66,1.08,0.862,0.806,2.15
HSS2.500x0.188,2.5,2.152,0.174,4.65,1.27,0.865,0.692,0.825,1.73
HSS2.500x0.125,2.5,2.268,0.116,3.17,0.869,0.619,0.495,0.844,1.24
HSS2.375x0.250,2.375,1.909,0.233,5.68,1.57,0.91,0.766,0.762,1.82
HSS2.375x0.218,2.375,1.967,0.204,5.03,1.39,0.827,0.696,0.771,1.65
HSS2.375x0.188,2.375,2.027,0.174,4.4,1.2,0.733,0.617,0.781,1.47
HSS2.375x0.154,2.375,2.089,0.143,3.66,1,0.627,0.528,0.791,1.25
HSS2.375x0.125,2.375,2.143,0.116,3.01,0.823,0.527,0.443,0.8,1.05
HSS1.900x0.145,1.9,1.63,0.135,2.72,0.749,0.293,0.309,0.626,0.586
HSS1.660x0.140,1.66,1.4,0.13,2.27,0.625,0.184,0.222,0.543,0.368";

        private static HSSPipeProfileServer instance = null;

        private HSSPipeProfileServer()
        {
            // Read the data.
            using (var reader = new StringReader(_data))
            {
                var lineCount = -1;
                while (true)
                {
                    lineCount++;
                    var line = reader.ReadLine();

                    if (lineCount == 0)
                    {
                        continue;
                    }

                    if (line != null)
                    {
                        var values = line.Split(',');
                        try
                        {
                            var profile = new HSSPipeProfile(values[0], Guid.NewGuid(), double.Parse(values[1]) * InchesToMeters,
                                                            double.Parse(values[2]) * InchesToMeters,
                                                            double.Parse(values[3]) * InchesToMeters)
                            {
                                wt = double.Parse(values[4]),
                                A = double.Parse(values[5]),
                                I = double.Parse(values[6]),
                                S = double.Parse(values[7]),
                                r = double.Parse(values[8]),
                                J = double.Parse(values[9])
                            };
                            _profiles.Add(values[0], profile);
                        }
                        catch
                        {
                            Console.WriteLine($"The section, {values[0]}, could not be loaded.");
                        }
                    }
                    else
                    {
                        break;
                    }
                }
            }
        }

        /// <summary>
        /// The HSSPipeProfileServer singleton.
        /// </summary>
        public static HSSPipeProfileServer Instance
        {
            get
            {
                if (instance == null)
                {
                    instance = new HSSPipeProfileServer();
                }
                return instance;
            }
        }
    }
}